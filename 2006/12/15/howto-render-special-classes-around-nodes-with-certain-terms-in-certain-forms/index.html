<!DOCTYPE html>



<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8" />

  <!-- Set the viewport width to device width for mobile -->
  <meta name="viewport" content="width=device-width" />
  <link rel="openid.server" href="http://openid.yubico.com/server.php" />
  <link rel="openid.delegate" href="http://openid.yubico.com/server.php/idpage?user=vvbdkthjbecc" />

   <title>HOWTO: render special classes around nodes with certain terms (in certain forms)</title>
   <meta name="author" content="Bèr ‘berkes’ Kessels" />
   <link href="http://feeds.feedburner.com/berkes" rel="alternate" title="HOWTO: render special classes around nodes with certain terms (in certain forms) Feed" type="application/atom+xml" />
   <link rel="author" href="/humans.txt" type="text/plain" />
   <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
   <!-- Included CSS Files -->
   <link rel='stylesheet' type='text/css' href='/bundles/66bfe58a92310a729441d3ebeed7faf2.css' />


   <!--[if lt IE 9]>
   <link rel='stylesheet' type='text/css' href='/bundles/5bf927c3c4faac96d17903f7ba5b378a.css' />

   <![endif]-->

   <script type='text/javascript' src='/bundles/2f42e0e43641f260414dd4eb0161fb9d.js'></script>


   <!-- IE Fix for HTML5 Tags -->
   <!--[if lt IE 9]>
   <script type='text/javascript' src='/bundles/69431f1ec831bacf31013dff2872cba0.js'></script>

   <![endif]-->
</head>
<body>
	<!-- container -->
	<div class="container">
    <header>
      <div class="row">
        <a href="/" title="Home">
          <img src="/assets//images/logo.png" alt="Logo" title="Bèr ‘berkes’ Kessels" />
        </a>
      </div>

      <nav id="main" class="row">
        <div class="onion">
        <ul>
          <li>
          <a href="/about.html">EN / About</a>
          </li>
          <li>
          <a href="/archive.html">EN / Articles</a>
          </li>
          <li>
          <a href="/over.html">NL / Over</a>
          </li>
          <li>
          <a href="/archief.html">NL / Artikelen</a>
          </li>
        </ul>
        </div>
      </nav>
    </header>
    <section id="main-content" class="row">
      <article>
  <header>
    <h1>HOWTO: render special classes around nodes with certain terms (in certain forms)</h1>
  </header> 
  <div class="body">
    <p>An often requested feature for sections module (or Theming in general) is to be able to style nodes with certain terms (and therefore forums) different.</p>

<p>Off course you can build a module for this, with a nice interface an all that. And off course you can do this with sections module. But both are quite over the top, for such a simple tasks; Worse: such modules will be big, but will never be able to cover all the cases and questions. A few lines of PHP in your theme is all you need. and PHP is as flexible as you want it to be.</p>

<p>This small howto will help you create some template code to add classes to your nodes, based on wether or not they contain certain terms. It will check for terms in a certain vocabulary only.</p>

<p>First we create a <a href="http://drupal.org/node/11811">template.php</a> if it is not in the theme yet.</p>

<p>In that file we will <a href="http://drupal.org/node/16383">define new variables</a>:</p>

<pre><code>/** Make additional variables available and override some core variables **/
function _phptemplate_variables($hook, $vars) {
  switch ($hook) {
    case 'node':
      $node = $vars['node'];
      if (count($node-&gt;taxonomy)) {
        foreach($node-&gt;taxonomy as $term) {
          if ($term-&gt;vid == 1) { //only check terms in vocabulary with ID 1;
            $classes[] = sympal_map_string_to_class($term-&gt;name);
          }
        }
        $vars['class_string'] = implode(' ', $classes);
      }
    break;
  }
  return $vars;
}
</code></pre>

<p>You will need to change the <strong>1</strong>  in <em>if ($term->vid == <strong>1</strong>) {</em> into the ID of your vocabulary.</p>

<p>Find the vocabulary ID by browsing to example.com/admin/taxonomy and hover "edit" the number in the URL, is the ID.</p>

<p>Off course you can ignore this check and get all terms in your node, but it might bring down performance, if you are making classes from each and every term.</p>

<p>If you want to do this only on certain content types (even better performance), for example 'story' types, then you will need to chance <em>if (count($node->taxonomy)) {</em> into <em>if (($node->type == 'story') &amp;&amp; count($node->taxonomy)) {</em></p>

<p>And then we need to create a helper function:</p>

<pre><code>/** 
* Maps a term to a class, for use in variables and node*.tpl.php files 
* @param $term any string.
* @param $prefix string to append to the mapping. Optional; defaults to term-
**/
function sympal_map_string_to_class($term, $prefix = 'term-') {
  // Find a valid, computer-friendly type name.
  $class = trim($term);
  $class = drupal_strtolower($class);
  $class = str_replace(array(' ', '_'), '-', $class);
  $class = preg_replace('/[^a-z0-9_]/', '', $class);
  $class = $prefix . $class;
  $class = substr($class, 0, 32);
  return $class;
}
</code></pre>

<p>The name of our theme here is 'sympal' best is to use your own themename, to avoid collisions.</p>

<p>Now we need to alter the node.tpl.php (create a new one if it does not exist), to print the classes. My default <a href="http://cvs.drupal.org/viewcvs/drupal/contributions/themes/sympal_theme/">sympal_theme</a> node template was:</p>

<pre><code>&lt;div class="article &lt;?php print $type; print ($sticky ? ' sticky' : NULL); print (!$published ? ' unpublished' : NULL); print ($page ? ' full-page' : ' teaser'); ?&gt;"&gt;&lt;div class="sliding-door"&gt;
  &lt;?php if ($page == 0): ?&gt;
    &lt;h3 class="&lt;?php print $type; ?&gt; title"&gt;&lt;a href="/&lt;?php print $node_url ?&gt;" title="&lt;?php print $title ?&gt;"&gt;&lt;?php print $title ?&gt;&lt;/a&gt;&lt;/h3&gt;
  &lt;?php endif; ?&gt;

  &lt;div class="body"&gt;
    &lt;?php print $content; ?&gt;
  &lt;/div&gt;

  &lt;?php if ($links): ?&gt;
    &lt;div class="links"&gt;&lt;?php print $links; ?&gt;&lt;/div&gt;
  &lt;?php endif; ?&gt;
&lt;/div&gt;&lt;/div&gt;
</code></pre>

<p>This will render the complete class, for a non sticky node, in full page mode, as follows:</p>

<pre><code>class="article full-page"
</code></pre>

<p>I want it to become:</p>

<pre><code>class="article full-page term-theming term-drupal"
</code></pre>

<p>For nodes tagged with "Theming" and "Drupal". So all that needs to change is the first line. Change it into:</p>

<pre><code>&lt;div class="article &lt;?php print $type; print ($sticky ? ' sticky' : NULL); print (!$published ? ' unpublished' : NULL); print ($page ? ' full-page' : ' teaser'); print ($class_string ? " $class_string" : NULL) ?&gt;"&gt;&lt;div class="sliding-door"&gt;
</code></pre>

<p>From now on you have the classes at your disposal. I am not going into CSS magic here, there are a gazillion sites out there that aer better resources. A quick example to get yo going, though:</p>

<pre><code>.article.term-drupal {
  background-color:green;
}
.article.teaser.term-drupal {
  background-color:blue;
}
</code></pre>

<p>Will render all your teasers that were tagged with Drupal in blue, it will render all the other node views with a green background.</p>

<p>I am working on addition for this in the sympal_theme, but will insert a small admin frontend for this, too. Small, because the best way to change the behaviour is to change the PHP. Nothing more powerful then that.</p>

  </div>
  <footer>
    <p class="note">
    
      <em>This article was published on webschuur.com. And migrated to this blog. </em>
    
    </p>
    <time datetime="2006-12-15T00:00:00+01:00"
    pubdate="pubdate">
      Posted on 15 December 2006
    </time>
    in
    
    
      
      


  
    
      <a href="/tags.html#php-ref" class="black radius label">php<span class="size">41</span></a>
    
      <a href="/tags.html#theming-ref" class="black radius label">theming<span class="size">25</span></a>
    
      <a href="/tags.html#css-ref" class="black radius label">css<span class="size">17</span></a>
    
      <a href="/tags.html#drupal-ref" class="black radius label">drupal<span class="size">214</span></a>
    
      <a href="/tags.html#whatsinitsname theme design blog-ref" class="black radius label">whatsinitsname theme design blog<span class="size">4</span></a>
    
  



    
  </footer>
</article>

<div id="author">
  <p>
  
  
    <strong>About  the author:</strong> Bèr Kessels is an experienced webdeveloper  with a great passion for
    technology and Open Source. A golden combination to implement that technology in a good and efficient
    way. Follow <a href="https://twitter.com/berkes">@berkes</a> on Twitter. Or read more <a href="/over.html">about Bèr</a>.
  
  </p>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'berkes'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<hr/>
<aside>
  
  
  <h1>Read on:</h1>
  
  <ul>
    
      <li><span>November 28, 2013</span> &raquo; <a href="/2013/11/28/olaf-van-den-heuvel-is-een-maximum-flapdrol">Olaf van den Heuvel is een maximum flapdrol</a></li>

    
      <li><span>November 27, 2013</span> &raquo; <a href="/2013/11/27/hoe-kom-ik-aan-bitcoin-en-een-bitcoin-rekening">Hoe kom ik aan Bitcoin, en een Bitcoin rekening?</a></li>

    
      <li><span>October  6, 2013</span> &raquo; <a href="/2013/10/06/i-am-a-webdeveloper-using-ruby-rails-and-other-open-source">I am a webdeveloper (using Ruby, Rails and other Open Source)</a></li>

    
  </ul>
</aside>


    </section>

    <footer class="main row">
      <div class="contact four columns">
        <p>
            Bèr ‘berkes’ Kessels<br />
            Bèr Kessels is an Open Source Webdeveloper.<br />
            <a href='mailto:ber@berk.es'>ber@berk.es</a>
          </p>
          <p>
            <a href="http://github.com/berkes/">github.com/berkes</a><br />
            <a href="http://twitter.com/berkes/">twitter.com/berkes</a><br />
          </p>
      </div>
      <div class="four columns">
        Copyright 2001-2014
        with a
        <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license">Creative Commons Attribute-Share-alike 3.0 Unported license</a>
      </div>
      <div class="four columns">
        <a class="extra" href="/archive.html">Archive (All English articles)</a> <br />
        <a class="extra" href="/archief.html">Archief (Alle Nederlandse artikelen)</a> <br />
        <a class="extra" href="/tags.html">Tags</a> <br />
        <a href="http://feeds.feedburner.com/berkes"> RSS </a> <br />
      </div>
    </footer>
  </div>
  <!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://piwik.webschuur.com/" : "http://piwik.webschuur.com/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 9);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://piwik.webschuur.com/piwik.php?idsite=9" style="border:0" alt="" /></p></noscript>
<!-- End Piwik Tracking Code -->

</body>
</html>
