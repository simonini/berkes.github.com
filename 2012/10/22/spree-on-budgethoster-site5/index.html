<!DOCTYPE html>



<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8" />

  <!-- Set the viewport width to device width for mobile -->
  <meta name="viewport" content="width=device-width" />
  <link rel="openid.server" href="http://openid.yubico.com/server.php" />
  <link rel="openid.delegate" href="http://openid.yubico.com/server.php/idpage?user=vvbdkthjbecc" />

   <title>Spree e-commerce on budgethoster Site5</title>
   <meta name="author" content="Bèr ‘berkes’ Kessels" />
   <link href="http://feeds.feedburner.com/berkes" rel="alternate" title="Spree e-commerce on budgethoster Site5 Feed" type="application/atom+xml" />
   <link rel="author" href="/humans.txt" type="text/plain" />
   <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
   <!-- Included CSS Files -->
   <link rel="stylesheet" href="/assets//stylesheets/foundation.css">
   <link rel="stylesheet" href="/assets//stylesheets/pygments.css">
   <link rel="stylesheet" href="/assets//stylesheets/app.css">

   <!--[if lt IE 9]>
   <link rel="stylesheet" href="/assets//stylesheets/ie.css">
   <![endif]-->

   <script src="/assets//javascripts/modernizr.foundation.js"></script>

   <!-- IE Fix for HTML5 Tags -->
   <!--[if lt IE 9]>
     <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
   <![endif]-->

   <!-- Fonts -->
   <link href='http://fonts.googleapis.com/css?family=Arvo:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
   <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=OFL+Sorts+Mill+Goudy+TT" media="screen, projection, print">
</head>
<body>
	<!-- container -->
	<div class="container">
    <header>
      <div class="row">
        <a href="/" title="Home">
          <img src="/assets//images/logo.png" alt="Logo" title="Bèr ‘berkes’ Kessels" />
        </a>
      </div>

      <nav id="main" class="row">
        <div class="onion">
        <ul>
          <li>
          <a href="/about.html">EN / About</a>
          </li>
          <li>
          <a href="/archive.html">EN / Articles</a>
          </li>
          <li>
          <a href="/over.html">NL / Over</a>
          </li>
          <li>
          <a href="/archief.html">NL / Artikelen</a>
          </li>
        </ul>
        </div>
      </nav>
    </header>
    <section id="main-content" class="row">
      <article>
  <header>
    <h1>Spree e-commerce on budgethoster Site5</h1>
  </header> 
  <div class="body">
    <figure>
  <img src="/images//2012/10/22/spree-on-budgethoster-site5.png" alt="Woodcut from Doré. Purely illustrative" />
  
    <figcaption>Doré Woodcut. Its only function is to make the layout look better. And these images are really nice themselves</figcaption>
  
</figure>

    <div class="content">
      <p>Recently I rolled out a
Ruby-on-Rails/<a href="http://spreecommerce.com">Spree</a>-based webshop on the
budgethoster <a href="htp://site5.com">Site5</a>. I thought to share some gotcha's, reasoning
around this project. To debunk the idea that hosting for Rails is either
complex and hard, or done on Heroku. To explain a bit about Spree as a
good option for your e-commerce (or not) and to go a little into how I modified
Spree.</p>

<p>My wife makes <a href="http://annatreurniet.nl">custom bags, smartphone- and tablet sleeves, and all sorts
of leather, handcrafted jewelery</a>. Obviously she wanted to sell some
through the internet; So I made her a webshop.</p>

<h2>Reasons for choosing for Spree</h2>

<p>I decided to go for Spree, after some investigation. A few important
reasons where:</p>

<ul>
<li>It's catchphrase <em>It was designed to make customization and upgrades
as simple as possible</em>.</li>
<li>It is built in Ruby on Rails, and that is what I do. (Although I
probably know more about PHP, and Drupal, at that).</li>
<li>We wanted a simple shop. Her needs are mostly simplicity; less
features in the shop equals better. Spree promises that; as opposed to
most ready-to-go shopping tools, that promise every feature you may
wish. And get in your way.</li>
<li>We needed flexibility. Simple means that it offers less options and
choices. But also that the business-logic needs to handle more.</li>
<li>I wanted the site to be ready for mobile and thus to be <a href="http://zomigi.com/blog/examples-of-flexible-layouts-with-css3-media-queries/">responsive</a>. Rails is ready for this. HTML5 and all that. So is Spree.</li>
</ul>


<p>Some reasons why I had thoughts about either writing my own e-commerce or
going with a PHP-solution were:</p>

<ul>
<li>I had (and have, read on) my questions about how true the catchphrase
<em>It was designed to make customization... as simple as possible</em> was,
in reality.</li>
<li>Spree is Rails. Rails requires professional hosting; not a problem for
a project developed for over 1k; where hosting at $20 per month is peanuts. In this
case $20 per month is far over budget; again, the insides of her exact
business-choices are out of scope for this project. Good-enough
PHP-hosters come for under the $5 per month.</li>
<li>I was going to build it for free, obviously. So we could not afford me
spending hundreds of hours on tweaking some tool, CSS and whatnot. A
turnkey-solution like <a href="https://en.wikipedia.org/wiki/Magento">Magento</a> would be a faster solution.</li>
<li>We chose the Dutch bank and payment provider <a href="https://www.rabobank.nl/bedrijven/producten/betalen_en_ontvangen/geld_ontvangen/rabo_omnikassa/">Omnikassa</a> because
they simply offered the best deal for her. There was no omnikassa
payment plugin for Spree, but there were some for more famous
frameworks.</li>
</ul>


<p>I went for Spree after proof-of-concepting my two biggest challenges:
offsite payment and (Zurb-foundation](http://foundation.zurb.com) as CSS/HTML framework, instead of
the default <a href="http://www.getskeleton.com/">Skeleton</a>, came out quite
alright. And a 30 days trial on <a href="https://www.site5.com/">Site5</a> proved me that hosting there was
going to work out.</p>

<h2>Zurb Foundation</h2>

<p>I replaced most views with my own HTML, so that I can use Zurb
foundation. It offered just a little more features, such as a <a href="http://foundation.zurb.com/docs/orbit.php">slider</a>
and more advanced responsive features; like hiding entire subtrees of
elements on certain devises.</p>

<p>In the end, we decided to go Desktop-first; I am re-doing some of the
views now, so they are prettier on mobile too. The reason we put this
lower in our todo, is that the most-used payment system in the
Netherlands, iDeal, trough our PSP omnikassa, is not mobile-friendly in
the first place. So why offer an entire mobile-webshop when people
cannot pay (properly) on a mobile?</p>

<p>It turned out to be really easy, but quite a journey of discovery trough all the
spree-gems and its views, before I found out what views to copy into my
own projects. The CSS was just as cumbersome to override. In the end, I
decided to simply do away with <em>all</em> CSS and JavaScript for the front-end and roll my own.</p>

<h2>Site5 Hosting.</h2>

<p>For under €5 per month you get a server with git, ssh-access and
Passenger to host your Rails application. A few Euro more for a static
IP address, which I need for the SSL-certificate. It is an e-commerce,
you need HTTPs.</p>

<p>It requires a <a href="http://kb.site5.com/ruby-on-rails/how-to-deploy-a-rails-3-application-with-phusion-passenger/">few settings to be changed</a> to my Rails application and it
requires Ruby <a href="http://kb.site5.com/ruby-on-rails/ruby-rails-gems/">1.8.7</a> since that is what their Passenger is configured
to use, but in the end it works just fine.</p>

<p>The only problem I had was some asset-precompiling issue, where the
compiler just died on me. After a support-call, the Site5-engineers upped
some memory on the server and I could compile just fine.
It turned out that some spree plugin came with several hundreds of
(demo) asset-files like huge videos that needed to be "compiled" by the
asset-pipeline. Cleaning up <a href="https://github.com/berkes/spree_slider/commits/master">Spree Slider</a> and removing its assets
fixed the issue for good. But hey, I don't expect a budget-hoster to
support me compiling hundreds of megabytes of video and other
demo-stuff. Fair enough.</p>

<p>Also, their uptime is reasonable. Not enterprise-alike reliable (IMHO), so I
have <a href="http://nagiosplugins.org/man/check_http">nagios</a> to check the
frontpage every several minutes for certain strings to occur (It looks
if the words "Anna Treurniet" occur in the <code>&lt;title&gt;</code>). Every odd
month (or so) there is a restart or some short downtime. One time Site5
changed the MySQL-setup (location of the socket moved to elsewhere) so I
had over half a day of downtime until solved. And now and again the
application gets shut-down for no clear reason, so it needs to boot,
resulting in the webshop loading very slow for one or two visitors. The
nagios checking actually kind-of solves this too, since it acts as a
"visitor" opening the site every five minutes.</p>

<p>All in all, I am very happy with this host. It offers far (far!) more then one
would expect from a €5/month. In my "enterprise"-jobs, I have to deal with €500-and-up-per-month
hosters who have far worse deals, support, deployment and uptime.</p>

<p>Their absolute biggest downside is the way their bulkhosting environment holds them back from upgrading to Ruby 1.9.3.
So, if you depend on a reasonable recent Ruby-version, bad luck.</p>

<h2>Git Deploy</h2>

<p>In order to keep the deployment smooth and somewhat close to the
experience I have with <a href="http://heroku.com">Heroku</a>, I use <a href="https://github.com/mislav/git-deploy">git-deploy</a>. Git deploy consists of a few simple hooks that run on the server in post-receive hooks. So, after you push your changes to production with <code>git push production</code>, the server runs a few commands, like (when needed) database-migrations, assets and cache-refreshing and then a restart of the Rails application. I have used this for <a href="http://www.berk.es/2012/08/03/git-deploy-or-how-i-learned-to-stop-worrying-and-love-deployment/">other, PHP-based systems too</a>.
Some problems, as mentioned above with asset-precompiling aside, it
works like a charm.</p>

<p>Obviously, when using git to manage the deployment, you need a <a href="http://www.jeffkreeftmeijer.com/2010/why-arent-you-using-git-flow/">good
branching and releasing management</a>. With that in place, I can fix and deploy changes within minutes. Yes. Minutes. Probably faster than most of you can log in over SSH, find the sourcecode on production, and hack a fix in with Vim.</p>

<h2>Testing and TDD</h2>

<p>Unfortunately, I did not manage to get good integration tests for Spree
going. Most of the extensions lack any form of tests. Spree itself is is
covered pretty well, but integrating Spree means changing configuration,
overriding behaviours with <a href="http://guides.spreecommerce.com/logic_customization.html">Decorators</a>. And I still have no idea how
to tests these properly. The rest is mostly view-overrides, which often
breaks Spree's own tests and requires me to rewrite all the spree-tests
in my application. It mostly boils down to my inexperience with testing
mostly, though.</p>

<h2>Omnikassa</h2>

<p>A <a href="http://www.spreecommerce.com/extensions/95-spree-omni">Spree Extension</a> was written to allow offsite-payment with the
Dutch payment-system Omnikassa. This is and was a mess. Spree had no
(proper) support for offsite payments, so I had to hack into the entire
checkout-workflow in order to get this payment-system going. The
Omnikassa-extension somehow breaks the feature in Spree to allow
discounts; it breaks certain orders in the back-end and whatnot. Spree
1.2.0 promises to have this checkout-workflow-inflexibility fixed, but
an upgrade is rather hard, seeing all the customisations the application
needed.</p>

<h2>Spree again?</h2>

<p>I don't think I will use Spree for a future e-commerce project. Despite
its promise to be the most flexible solution, I found it making too much
assumptions and being far too inflexible in areas. I'd rather roll my
own, next time.
The most important parts that Spree offers me, are either very easy to
develop myself (products, categories, their views, content-management),
 not needed (credit card-handling, user-login, 3rd party
 statistics) or covered in solid Rails plugins (administration, editors).</p>

<p>Against small-things-made-hard, like changing the checkout-workflow
(one-click-checkout?, offsite-payments), manually ordering the products
on the frontpage, integrating a simple CMS for the few "static pages"
and so on. Usually, in an Average Rails-projects these things take a
few hours programming and deploying. Here they took me days of stepping
through spree-core code in order to understand how my Decorator did
(not) change some ordering or some menu-addition.</p>

<p>For me, Spree offers me too little benefits to overcome its downsides. Despites
its promise, it is very much a ready-made application, which works
according to various assumptions about workflow, features and even looks, that you can
configure and beat into shape; mostly. The very same conceptual things that <a href="http://www.berk.es/2012/10/01/farewell-drupal/">Drove me
from Drupal</a>.</p>

<p>But overall, rolling a simple, Spree-site on Site5, gives you a
well-designed, ready-to-go e-commerce environment for under €10 per
month. And with a few hacks and tools, you can make the deployment to
that host really easy. Whether Spree is the best solution for your
e-commerce needs, depends on how much (and what exactly) you need to
customize.</p>

    </div>
  </div>
  <footer>
    <time datetime="2012-10-22T00:00:00+02:00"
    pubdate="pubdate">
      Posted on 22 October 2012
    </time>
    in
    
    
      
      


  
    
      <a href="/tags.html#whitepaper-ref" class="black radius label">whitepaper<span class="size">1</span></a>
    
      <a href="/tags.html#ruby on rails-ref" class="black radius label">ruby on rails<span class="size">14</span></a>
    
      <a href="/tags.html#spree-ref" class="black radius label">spree<span class="size">1</span></a>
    
      <a href="/tags.html#e-commerce-ref" class="black radius label">e-commerce<span class="size">3</span></a>
    
      <a href="/tags.html#hosting-ref" class="black radius label">hosting<span class="size">1</span></a>
    
      <a href="/tags.html#server-ref" class="black radius label">server<span class="size">17</span></a>
    
      <a href="/tags.html#site5-ref" class="black radius label">site5<span class="size">1</span></a>
    
      <a href="/tags.html#git-deploy-ref" class="black radius label">git-deploy<span class="size">1</span></a>
    
  



    
  </footer>
</article>

<div id="author">
  <p>
  
  
    <strong>About  the author:</strong> Bèr Kessels is an experienced webdeveloper  with a great passion for
    technology and Open Source. A golden combination to implement that technology in a good and efficient
    way. Follow <a href="https://twitter.com/berkes">@berkes</a> on Twitter. Or read more <a href="/over.html">about Bèr</a>.
  
  </p>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'berkes'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<hr/>
<aside>
  
  
  <h1>Read on:</h1>
  
  <ul>
    
      <li><span>February  3, 2015</span> &raquo; <a href="/2015/02/03/selecting-a-good-wysiwyg-for-rails-its-all-about-usecases">Selecting A Good Wysiwyg For Rails Its All About Usecases</a></li>

    
      <li><span>February  4, 2014</span> &raquo; <a href="/2014/02/04/new-post">Uitgevers, geef mij niet de schuld, wanneer ik mijn ebooks niet van jullie koop!</a></li>

    
      <li><span>November 28, 2013</span> &raquo; <a href="/2013/11/28/olaf-van-den-heuvel-is-een-maximum-flapdrol">Olaf van den Heuvel is een maximum flapdrol</a></li>

    
  </ul>
</aside>


    </section>

    <footer class="main row">
      <div class="contact four columns">
        <p>
            Bèr ‘berkes’ Kessels<br />
            Bèr Kessels is an Open Source Webdeveloper.<br />
            <a href='mailto:ber@berk.es'>ber@berk.es</a>
          </p>
          <p>
            <a href="http://github.com/berkes/">github.com/berkes</a><br />
            <a href="http://twitter.com/berkes/">twitter.com/berkes</a><br />
          </p>
      </div>
      <div class="four columns">
        Copyright 2001-2015
        with a
        <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license">Creative Commons Attribute-Share-alike 3.0 Unported license</a>
      </div>
      <div class="four columns">
        <a class="extra" href="/archive.html">Archive (All English articles)</a> <br />
        <a class="extra" href="/archief.html">Archief (Alle Nederlandse artikelen)</a> <br />
        <a class="extra" href="/tags.html">Tags</a> <br />
        <a href="http://feeds.feedburner.com/berkes"> RSS </a> <br />
      </div>
    </footer>
  </div>
  <!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://piwik.webschuur.com/" : "http://piwik.webschuur.com/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 9);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://piwik.webschuur.com/piwik.php?idsite=9" style="border:0" alt="" /></p></noscript>
<!-- End Piwik Tracking Code -->

</body>
</html>
